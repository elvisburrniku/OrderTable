# Restaurant Booking Dashboard

## Project Overview
A comprehensive restaurant booking management system with React frontend and Express backend. Features include table management, booking calendar, special periods configuration, Google Calendar integration, and subscription management.

## Architecture
- **Frontend**: React with Vite, TypeScript, Tailwind CSS
- **Backend**: Express.js with TypeScript
- **Database**: PostgreSQL (Neon-backed)
- **Authentication**: Passport.js with multiple SSO providers
- **Email**: Brevo API integration
- **Payments**: Stripe integration

## Key Features
- Multi-tenant restaurant management
- Interactive booking calendar (Google Calendar clone)
- Table layout management
- Special periods configuration (holidays, events)
- Email notifications and reminders
- Payment processing
- Activity logging
- Kitchen order management

## Recent Changes
- **2025-07-03**: ✅ MIGRATION COMPLETED - Successfully migrated from Replit Agent to Replit environment with full functionality restored
- **Migration Success**: All features operational including PostgreSQL database, multi-tenant restaurant management, payment processing, booking system, and admin panel
- **Service Integration**: Email (Brevo), SMS (Twilio), Google Calendar, Stripe payments, and survey scheduler all working correctly
- **Security Enhanced**: Maintained robust client/server separation and security practices throughout migration
- **Development Ready**: Application running smoothly on port 5000 with proper host binding (0.0.0.0) for Replit compatibility
- **Database Connected**: PostgreSQL database connection established and all services initialized properly
- **2025-07-03**: ✅ PRINT ORDERS PROFESSIONAL REDESIGN - Transformed print orders page from colorful animated design to professional business interface
- **Professional Design Enhancement**: Replaced vibrant colors and heavy animations with clean slate color scheme for business-appropriate appearance
- **Simplified Interface**: Removed excessive framer-motion animations, gradients, and decorative elements for cleaner professional look
- **Consistent Styling**: Applied professional styling to header, tabs, statistics cards, filters, and table with slate/white color palette
- **Business Focus**: Enhanced "Create order" and "Menu printing" sections with professional design patterns matching enterprise applications
- **Clean Typography**: Standardized text sizing and weights for better readability and professional presentation
- **2025-07-03**: ✅ PAYMENT LINK SECURITY FIX - Fixed prepayment URLs to include secure hash parameters for proper authentication
- **Security Enhancement**: Updated all payment link generation to use BookingHash.generatePaymentUrl method ensuring secure hash-based authentication
- **Email Service Fix**: Modified Brevo email service to generate secure payment links with tenant, restaurant, and hash parameters
- **Routes Fix**: Fixed insecure payment link generation in routes.ts line 6572 that was creating URLs without hash parameters
- **System Validation**: All payment links now include required security parameters: booking, tenant, restaurant, amount, currency, and hash
- **Hash Verification**: Confirmed that secure API endpoints properly validate hash parameters before granting access to payment pages
- **Migration Complete**: Eliminated all instances of insecure prepayment URLs that lacked hash-based authentication
- **2025-07-02**: ✅ KITCHEN DASHBOARD PROFESSIONAL REDESIGN - Applied menu management design patterns to kitchen dashboard for consistent professional appearance
- **Professional Kitchen UI**: Redesigned kitchen dashboard with slate color scheme, gradient header, framer motion animations, and enhanced visual hierarchy
- **Design Consistency**: Matched professional styling from menu management including background colors, card designs, animations, and typography
- **Enhanced Components**: Updated metrics cards with icon backgrounds, improved tabs with icons, professional loading states, and empty state designs
- **Animation Integration**: Added staggered animations for cards, rotating loading indicators, and smooth transitions throughout the interface
- **2025-07-02**: ✅ MENU MANAGEMENT PROFESSIONAL REDESIGN - Applied heat map page design patterns to menu management for consistent professional appearance
- **Professional Design Enhancement**: Enhanced menu management page with slate color scheme, framer motion animations, professional header layout, and improved typography
- **Design Consistency**: Applied same visual patterns as heat map page including header structure, background colors, button styling, and spacing
- **User Experience**: Added smooth animations, professional tab navigation, dynamic header content, and improved loading states
- **Visual Polish**: Enhanced with proper border styling, shadow effects, color consistency, and responsive design elements
- **2025-07-02**: ✅ USER MANAGEMENT TABLE REDESIGN - Enhanced team member table with modern design matching customers page
- **Enhanced User Interface**: Redesigned user management table with pagination, filters, animations, and improved visual hierarchy
- **Modern Table Design**: Implemented responsive table with alternating row colors, hover effects, and professional styling
- **Filtering System**: Added search functionality for names/emails and role-based filtering with active filter indicators
- **Pagination Implementation**: Full pagination system with first/last buttons, page numbers, and items per page control
- **Delete Confirmation**: Added confirmation dialog for user removal with clear warning messages and loading states
- **Available Roles Display**: Converted roles overview to professional table format with permission counts and access levels
- **Animation Integration**: Smooth entry animations for table rows and loading states using Framer Motion
- **Visual Consistency**: Matched design patterns from customers page including color schemes, badges, and button styles
- **2025-07-02**: ✅ PREPAYMENT SYSTEM FULLY OPERATIONAL - Fixed payment service integration and verified complete guest payment flow
- **Payment Service Fix**: Corrected payment intent creation by using proper method name `createBookingPaymentIntent` instead of `createPaymentIntent`
- **API Integration**: Updated payment intent endpoint parameters to match PaymentService interface requirements for booking details
- **Guest Payment Flow**: Comprehensive testing confirms PrePayment page loads correctly, creates payment intents, and processes guest bookings
- **Stripe Connect**: Verified working integration with restaurant-specific Stripe Connect accounts for payment processing
- **System Status**: All components operational - guest booking API, payment intent creation, PrePayment page accessibility, and backend infrastructure
- **2025-07-02**: ✅ GUEST PREPAYMENT SYSTEM & ADMIN PAYMENT LINK MANAGEMENT - Complete guest payment interface with admin resend functionality
- **Guest Payment Interface**: Fixed PrePayment page to work as guest interface without authentication, includes request new payment link functionality for customers
- **Admin Payment Management**: Added resend payment link button in booking detail page for admins, sends new payment links directly to customer email
- **Customer Link Request**: Customers can request new payment links by providing contact verification, which notifies restaurant admins via email
- **Enhanced Error Handling**: PrePayment page now gracefully handles invalid/expired links with user-friendly error messages and recovery options
- **Payment Status Integration**: Updated booking status system to include "waiting_payment" status and proper status transitions for payment-required bookings
- **Email Template Enhancement**: Modified booking confirmation emails to use PrePayment links instead of authenticated payment page links
- **Database Integration**: Fixed authentication middleware issues and ensured proper tenant validation for payment-related endpoints
- **2025-07-02**: ✅ BOOKING PAYMENT INTEGRATION - Complete payment processing system integrated with booking flow
- **Payment Integration Features**: Booking payment system with Stripe Connect, payment links in emails, guest booking payment options, and admin payment link generation
- **Guest Booking Enhancement**: Added payment step to booking flow allowing customers to require payments, set amounts, and send payment links via email
- **Email Payment Links**: Enhanced booking confirmation emails to include secure payment links with clear payment instructions and deadlines
- **API Payment Endpoints**: New endpoints for creating payment links for existing bookings and processing payments through Stripe Connect
- **Payment Service**: Comprehensive PaymentService class for handling Stripe Connect payment intents, payment links, and status management
- **Database Integration**: Enhanced booking schema with payment fields including amount, deadline, status, and payment intent tracking
- **Admin Payment Management**: Restaurant admins can generate payment links for any booking with automatic Stripe Connect integration
- **2025-07-02**: ✅ STRIPE CONNECT CHARGES & PAYOUTS ENABLEMENT - Enhanced Stripe Connect onboarding with comprehensive setup guidance
- **Enhanced Onboarding Flow**: Changed from standard to Express accounts for simplified restaurant setup and faster approval process
- **Improved Error Handling**: Added specific error messages for Stripe Connect not being enabled, with clear instructions to enable it on Stripe dashboard
- **Status-Based UI**: Payment gateway now shows different alerts based on whether charges and payouts are enabled, with contextual action buttons
- **Complete Setup Button**: Added "Complete Setup" button that appears when charges or payouts are disabled, directing users to finish onboarding
- **Setup Instructions**: Added step-by-step instructions for enabling charges and payouts through Stripe's verification process
- **Better User Experience**: Enhanced status display shows exact account capabilities and provides clear next steps for full functionality
- **2025-07-02**: ✅ MIGRATION COMPLETED - Successfully migrated from Replit Agent to Replit environment with full Stripe Connect integration
- **Migration Achievements**: Fixed database connection issues, resolved null reference errors, configured environment variables, and enhanced payment gateway page
- **Stripe Connect Enhancement**: Updated payment gateway page with real-time status checking, onboarding flow, and comprehensive connection management
- **Error Resolution**: Fixed admin storage null checks, survey scheduler database access, and Brevo email configuration issues
- **Environment Setup**: Created development environment configuration with placeholder keys and proper service initialization
- **Security Maintained**: Preserved robust client/server separation and security practices throughout migration process
- **2025-07-01**: ✅ STRIPE CONNECT PAYMENT GATEWAY IMPLEMENTED - Complete multi-tenant payment processing system with streamlined onboarding
- **Payment Gateway Features**: Implemented comprehensive Stripe Connect integration allowing tenants to accept payments through their own Stripe accounts
- **Connect Button & Onboarding**: Created streamlined onboarding flow with Connect button that guides tenants through Stripe account setup and verification
- **Payment Processing API**: Built secure payment intent creation, webhook handling, and transaction tracking with 5% platform fee structure
- **Payment Management Dashboard**: Developed modern payment settings page with account status, transaction history, and connection management
- **Multi-tenant Architecture**: Properly isolated payment accounts per tenant with secure API endpoints and proper validation
- **Database Schema**: Added stripe_payments and stripe_transfers tables with comprehensive payment tracking and tenant association
- **Frontend Components**: Created reusable payment components including BookingPayment, PaymentPage, and StripeConnectSettings
- **Security & Compliance**: Implemented proper Stripe webhook verification, secure client secret handling, and PCI-compliant payment processing
- **2025-07-01**: ✅ AUTOMATED POST-VISIT SURVEY SCHEDULER IMPLEMENTED - Complete survey system with automated scheduling
- **Survey Scheduling**: Automatically schedules feedback requests 2 hours after customers complete dining
- **Survey Delivery**: Sends surveys via email and SMS with personalized messages and unique survey links
- **Survey Response System**: Public survey response page with star ratings, feedback comments, and restaurant branding
- **Survey Management**: Administrative dashboard with survey statistics, schedules, and response tracking
- **Database Integration**: Added survey_schedules table with comprehensive tracking of delivery status, attempts, and responses
- **Automated Processing**: Background service processes pending surveys every 5 minutes with retry logic and error handling
- **Customer Experience**: Beautifully designed responsive survey page with restaurant context and booking details
- **2025-07-01**: ✅ MIGRATION COMPLETED - Fixed SMS and email notification triggers in booking creation
- **Notification System**: Both manual and guest bookings now automatically send SMS and email confirmations when customers provide contact information
- **SMS Integration**: Twilio service configured and working (trial account limits SMS to verified numbers only)
- **Email Integration**: Brevo service fully operational with booking confirmation emails including management links
- **Error Resolution**: Fixed missing variable declarations in email service and improved error handling for both SMS and email services
- **2025-07-01**: Successfully completed migration from Replit Agent to Replit environment with all errors resolved
- **Frontend Error Fixed**: Resolved DialogDescription import error in admin panel causing component crashes
- **Migration Verification**: All APIs tested and functioning correctly - tenant management, admin authentication, and database operations working
- **Backend Stability**: Server running stable on port 5000 with proper database connections and authentication systems
- **Admin Panel Operational**: Fixed tenant data display issues, duplicate user records, missing imports, and optimized database queries
- **API Testing**: Verified admin login (admin@replit.com/admin123456), tenant listing, and detailed tenant views all working correctly
- **Security Enhancement**: Maintained robust client/server separation and security practices throughout migration
- **Environment Compatibility**: Application fully adapted for Replit environment with proper host binding (0.0.0.0)
- **2025-07-01**: Fixed admin panel tenant data display issue - restored proper restaurant and user counts for each tenant
- **Admin Panel Enhancement**: Fixed missing tenantUsers import causing ReferenceError in admin storage methods
- **Database Integration**: Enhanced getAllTenants and getTenantById methods to properly fetch restaurant, user, and booking counts
- **Error Resolution**: Resolved "tenantUsers is not defined" error that was preventing tenant data from loading in admin panel
- **Data Accuracy**: Admin panel now correctly displays actual counts for restaurants, users, and bookings per tenant
- **2025-07-01**: Successfully completed migration from Replit Agent to Replit environment with full functionality
- **SMS Settings Redesign**: Completely redesigned SMS settings page with modern, professional interface featuring gradient backgrounds, status badges, responsive layout, and enhanced user experience
- **Migration Success**: All features operational including PostgreSQL database, SMS integration, payment processing, multi-tenant system, and admin panel working perfectly
- **Migration Success**: Fixed all startup issues including Stripe initialization, database connections, and admin storage to work gracefully without external dependencies
- **Development Ready**: Application now runs smoothly on port 5000 with in-memory storage for development and testing
- **Robust Error Handling**: Implemented comprehensive fallback mechanisms for missing API keys and database connections
- **Security Enhanced**: Maintained proper client/server separation and security practices throughout migration
- **2025-07-01**: Completed migration from Replit Agent to Replit environment with enhanced subscription billing management
- **Admin Subscription Management**: Implemented automatic Stripe subscription price updates when admins change tenant subscription plans in the admin panel
- **Real-time Billing Integration**: When subscription plans are updated via admin panel (e.g., from $299 to $199), the system automatically updates Stripe subscription with prorated billing
- **Enhanced Admin Interface**: Added subscription pricing update section in tenant management with price change preview and automatic Stripe integration
- **Comprehensive Logging**: All subscription price changes are logged with detailed information including proration amounts and billing cycle updates
- **Error Handling**: Robust error handling for Stripe API failures with fallback to local database updates and detailed error logging
- **User Feedback**: Clear success/error messages showing billing changes, proration details, and next billing cycle information
- **2025-07-01**: Implemented multi-tenant restaurant management system with subscription-based restaurant creation and tenant switching
- **Multi-Tenant System**: Users can create multiple restaurants based on subscription limits and switch between them seamlessly
- **Tenant Switcher**: Dashboard sidebar includes restaurant switcher dropdown with owner indicators and subscription status
- **Restaurant Creation**: Owners can create new restaurants within subscription limits with automatic tenant and restaurant setup
- **Database Architecture**: Enhanced storage methods for tenant management, user tenant associations, and restaurant-tenant relationships
- **Subscription Limits**: Restaurant creation respects subscription plan limits with clear error messaging for exceeded limits
- **Session Management**: Proper tenant switching with session updates and automatic page refreshes for context switching
- **2025-06-30**: Implemented comprehensive shop system with admin management and public storefront
- **Shop System**: Complete e-commerce platform for selling services like marketing, branding, design, and printing
- **Admin Management**: Full CRUD interface for categories, products, and orders accessible via admin@replit.com
- **Public Storefront**: Customer-facing shop page at /shop with product browsing, cart functionality, and Stripe integration
- **Product Categories**: Marketing Services, Branding & Design, Print Services, and Digital Solutions with sample products
- **Payment Processing**: Integrated Stripe payment system for secure transactions and order management
- **Database Integration**: Shop tables (categories, products, orders, settings) with proper relationships and validation
- **2025-07-01**: Completed comprehensive Twilio SMS integration for restaurant booking notifications
- **SMS Integration Features**: Implemented booking confirmation SMS, reminder SMS, balance tracking, delivery status monitoring, and cost management
- **Frontend SMS Interface**: Created SMS settings page with configuration options, balance display, and message history
- **Backend SMS Infrastructure**: Built complete Twilio API integration with automatic booking triggers and webhook support
- **Database Schema**: Added SMS-related tables (sms_balance, sms_messages, sms_settings) with proper relationships
- **API Endpoints**: Created comprehensive SMS API for settings, messages, balance management, and Twilio account info
- **Automated Services**: Implemented SMS reminder service integrated with existing booking reminder system
- **Security**: Properly configured Twilio credentials as environment variables with secure access patterns
- **2025-06-30**: Successfully completed migration from Replit Agent to Replit environment
- **Migration Completed**: Fixed database schema issues (missing redirect column in roles table), resolved authentication system, and ensured full application functionality
- **Table Plan Enhancement**: Removed "On Floor Plan" text from table listings in the floor plan page for cleaner UI
- **Conflicts Page Redesign**: Implemented professional design with gradient backgrounds, stats dashboard, glassmorphism effects, and enhanced user experience
- **Security Implementation**: Maintained robust client/server separation and security practices during migration
ion, allowing different PWA configurations for specific screens (Dashboard, Bookings, Kitchen, Floor Plan, Menu)
- **Smart Installation**: PWA install prompts appear only on designated routes with customized app names, icons, and functionality per screen
- **Offline-First Strategy**: Enhanced service worker with comprehensive caching strategies for API responses and static resources
- **Developer Tools**: Dynamic PWA debug interface for testing route-specific PWA configurations and installation flows
- **Mobile App Experience**: Each major section can be installed as a separate PWA with tailored shortcuts and branding
- **2025-06-30**: Implemented database-based role redirects system - user redirects after login now use role redirect settings stored in database instead of static configurations
- **2025-06-30**: Fixed role determination logic in authentication system to properly query tenant_users table with both tenantId and userId filters
- **2025-06-30**: Implemented unified booking modal component ensuring consistent booking interface across dashboard and bookings pages
- **2025-06-30**: Fixed database syntax error in custom fields query to resolve SQL errors during booking form loading
- **2025-06-30**: Fixed React hooks error and removed duplicate notification components from dashboard to eliminate double display
- **2025-06-30**: Added authentication checks to notification indicator - only shows for authenticated users, preventing display on login/register pages
- **2025-06-30**: Implemented functional notification dropdown with real-time notifications and user menu with Profile, Settings, Billing, Help, and Logout options
- **2025-06-30**: Added notification indicator with bell icon and green dot to appear on every page across all layouts
- **2025-06-30**: Implemented role-based sidebar filtering to show only menu items users have permission to access
- **2025-06-30**: Added permission requirements to all sidebar menu items and restaurant settings dropdown
- **2025-06-30**: Fixed role permissions system with complete drag-and-drop functionality, remove buttons, and proper backend validation
- **2025-06-30**: Enhanced role permissions backend with improved request validation and owner role protection
- **2025-06-30**: Added remove functionality to assigned permissions with visual indicators and proper state management
- **2025-06-30**: Fixed React hooks violation in real-time table status component causing "more hooks than during previous render" error
- **2025-06-30**: Resolved database constraint issues by making restaurant_id nullable in activity_log table for proper activity logging
- **2025-06-30**: Successfully migrated to fresh PostgreSQL database instance with all essential tables properly initialized
- **2025-06-27**: Fixed subscription access restrictions for cancelled subscriptions - users can now access all essential features
- **Subscription System**: Modified permission middleware to allow core restaurant management functionality even with cancelled subscriptions
- **Access Control**: Users with cancelled subscriptions can access dashboard, bookings, customers, menu, tables, kitchen, settings, floor plan, user management, and billing features
- **Permission Fix**: Added comprehensive permission list for cancelled subscriptions including MANAGE_BILLING, ACCESS_USERS, VIEW_USERS, MANAGE_USERS
- **Calendar Component**: Fixed JavaScript errors with safety checks for undefined properties in enhanced-google-calendar component
- **Database Schema**: Resolved missing column issues by adding event_type, payment fields, and other required booking columns
- **2025-06-27**: Completed Interactive Restaurant Floor Plan Designer with drag-and-drop functionality
- **Floor Plan Designer**: Implemented comprehensive floor plan system with visual drag-and-drop interface for tables, chairs, walls, doors, windows, and decorations
- **Database Schema**: Added floor_plans and floor_plan_templates tables with complete element positioning and styling support
- **Backend Infrastructure**: Created full API endpoints in server/routes.ts and storage methods in db-storage.ts for floor plan CRUD operations
- **Frontend Implementation**: Built dedicated floor plan page at /floor-plan with SVG-based rendering, element selection, property editing, and grid snapping
- **Element Management**: Support for multiple element types with customizable properties including table numbers, capacity, colors, and positioning
- **Save/Load System**: Floor plans can be saved to database and loaded for editing with proper validation and error handling
- **Visual Interface**: Modern UI with toolbar for element selection, property panels, grid controls, and real-time visual feedback
- **2025-06-27**: Completed comprehensive booking settings implementation with all 7 requested features fully integrated application-wide
- **Booking Feature Implementation**: Successfully implemented duration control (start/end time), empty seats functionality, turnaround time, contact method options, cancellation controls, cancellation notice periods, and group request functionality
- **Application-wide Integration**: All booking features work consistently across dynamic booking form, booking calendar, booking cancellation component, and API endpoints
- **Duration & Time Controls**: UseEndingTime setting toggles between start/end time or duration-based booking, with automatic end time calculation including turnaround time buffer
- **Table Management**: Empty seats setting filters available tables based on required capacity (guest count + empty seats), ensuring proper table allocation
- **Contact Method Validation**: Phone, email, or both options with proper form validation ensuring required contact information is collected
- **Cancellation System**: AllowCancellationAndChanges enables/disables cancellation functionality with notice periods from none to 1 week validation
- **Group Request Feature**: GroupRequest setting displays special notices for large party bookings and enables customized booking workflows
- **API Endpoints**: Added booking cancellation endpoint with proper validation, logging, and status management
- **Booking Context Provider**: Centralized all 7 booking features in BookingProvider context with validation helpers and settings integration
- **Settings Integration**: Implemented CurrencyProvider and BookingProvider contexts for centralized timezone, currency, and booking duration controls
- **Currency System**: All subscription plans, billing, and financial components now use consistent currency formatting based on user settings
- **Timezone Support**: Date formatting respects user timezone settings throughout billing, subscriptions, and booking components
- **Application-wide Consistency**: Settings control entire app behavior - timezone affects all time displays, currency affects all prices including subscriptions
- **2025-06-27**: Successfully migrated from Replit Agent to Replit environment with PostgreSQL database integration
- **Migration Completed**: Fixed React context provider ordering, resolved missing setLocation import, and established secure database connectivity
- **Database Setup**: Created PostgreSQL database with complete schema migration (56 tables) and initialized admin system with default credentials
- **Security Enhancements**: Implemented robust error handling in DateProvider context and maintained client/server separation patterns
- **2025-06-29**: Successfully migrated project from Replit Agent to Replit environment
- **Migration Completed**: Database connection established, server startup optimized, and authentication system working
- **Table Chair Enhancement**: Fixed chair rotation to move with table rotation while maintaining even spacing around table perimeter
- **Security Implementation**: Established proper client/server separation and robust security practices
- **2025-06-27**: Fixed guest booking system initialization errors and completed special periods functionality
- **Bug Fix Resolution**: Resolved function redeclaration errors that were preventing guest booking system from loading properly
- **Special Periods Smart Logic**: When "Restaurant is open during this period" is enabled, system uses custom opening/closing times from special period configuration instead of blocking dates
- **Dynamic Time Slots**: Guest booking system generates time slots based on special period hours when restaurant is open during configured periods
- **Flexible Configuration**: Special periods now support both closure periods (blocked dates) and modified hours periods (custom times)
- **Comprehensive Booking Restrictions**: Guest booking system prevents bookings based on opening hours, special periods, and cut-off time configurations
- **Calendar Integration**: Calendar view visually disables dates blocked by configuration restrictions while allowing dates with modified hours
- **Enhanced Validation**: Updated time slot validation and generation to prioritize special period hours over regular opening hours
- **System Stability**: Guest booking system now loads without errors and properly handles all configuration scenarios
- **Priority System Implementation**: Established clear booking restriction hierarchy - Special periods override opening hours, cut-off times enforce time buffers
- **Cut-off Time Logic**: Enhanced cut-off validation to handle both hourly (1:00 = 1 hour before) and daily (24:00 = 1 day before) restrictions
- **Cut-off Time Fix**: Fixed hourly cut-off logic - if current time is 11:00 AM and cut-off is 1 hour, blocks bookings until after 12:00 PM
- **Elegant Loading Skeletons**: Implemented comprehensive loading skeletons for async content with shimmer animations and glassmorphism design
- **Skeleton Components**: Added RestaurantInfoSkeleton, CalendarSkeleton, TimeSlotsSkeletonGrid, BookingFormSkeleton, and TableSelectionSkeleton
- **Enhanced UX**: Loading states now show elegant animated placeholders while data loads instead of blank or loading spinners
- **Heat-Map Integration**: Heat-map now uses actual table positions, shapes, and rotations from table-plan page instead of hardcoded positions
- **Enhanced Visualization**: Added animated heat rings for high-performance tables, improved tooltips with detailed metrics, and room backgrounds
- **Bug Fix**: Fixed guest booking error by adding comprehensive null checks to isTimeSlotValid function preventing undefined property access
- **User Experience**: Tables now display exactly where positioned in table-plan with correct visual representation and interactive effects
- **Bug Fix**: Fixed guest booking error by adding comprehensive null checks to isTimeSlotValid function preventing undefined property access
- **User Experience**: Tables now display exactly where positioned in table-plan with correct visual representation and interactive effects
- **2025-06-26**: Completed comprehensive role-based access control system with page-level permissions and role-based redirects
- **Permission System**: Implemented AutoPermissionGuard wrapping all authenticated routes for automatic access control
- **Role Permissions Interface**: Created dedicated role permissions management page accessible via Users → Role Permissions button
- **Access Control Fix**: Added ACCESS_USERS permission to manager role enabling access to user management and role configuration pages
- **Page-Level Security**: Permission guard validates access to each page based on user role and redirects unauthorized users to appropriate pages
- **2025-06-26**: Completed comprehensive role-based access control system with endpoint-level security
- **Security Implementation**: Applied permission middleware to all critical endpoints to enforce role-based access control
- **Agent Restrictions**: Agents now blocked from user management, billing, subscription management, and administrative functions
- **Permission Matrix**: Full enforcement of granular permissions across user operations, financial management, and tenant administration
- **Endpoint Security**: Systematically secured billing, subscription, user invitation, role management, and administrative endpoints
- **2025-06-26**: Completed comprehensive user management system with full CRUD operations and role-based permissions
- **User Management System**: Built complete team member management with invite system, role assignment, and permission matrix
- **Database Structure**: Created proper restaurant management data model with users, roles, and permissions tables
- **API Integration**: Implemented all CRUD endpoints for user operations with proper authentication and validation
- **Role-Based Access**: Predefined roles (Owner, Manager, Agent, Kitchen Staff) with granular permission control system
- **Authentication System**: JWT-based authentication working properly for restaurant management operations
- **Database Migration Fix**: Fixed timeout issues with schema push by manually creating missing tables and foreign key constraints
- **Restaurant System**: Fully operational multi-tenant restaurant management with role-based permissions and subscription limits
- **Schema Alignment**: Updated table references to use correct naming conventions and resolved all foreign key relationships
- **2025-06-25**: Enhanced pause functionality with automatic unpause and smart scheduling system
- **Automatic Unpause**: Implemented scheduled task that checks every 5 minutes for expired pause periods and automatically reactivates accounts
- **Smart Scheduling**: Added automatic schedule creation when pausing tenants, with console logging and admin visibility
- **Enhanced User Experience**: Paused users now see exact pause end dates and automatic reactivation messages
- **Schedule Tracking**: New API endpoint `/api/admin/schedules/unpause` to view upcoming automatic unpause events
- **Database Schema**: Added pause_start_date, pause_end_date, pause_reason, and suspend_reason fields to tenants table
- **Authentication Guards**: Updated all authentication endpoints to handle pause expiration and provide clear user messaging
- **Admin Panel**: Enhanced pause functionality requires end date and reason, with improved validation and logging
- **Console Monitoring**: Server startup shows pending schedules and tracks completion with detailed logging
- **Real-time Countdown**: Admin panel displays live countdown timers showing exactly when each paused tenant will be automatically reactivated
- **Immediate Startup Check**: System runs automatic unpause check on server startup plus every 2 minutes for responsive reactivation
- **Session Management**: Added automatic session cleanup and reactivation for expired pause periods during validation
- **2025-06-25**: Enhanced admin tenant management system with comprehensive CRUD operations
- **Tenant Management**: Added ability to view detailed tenant information, edit tenant data, and manage subscription status
- **Suspend/Pause Features**: Implemented tenant suspension and pause functionality with reason tracking and automatic logging
- **Admin UI Enhancement**: Created detailed tenant view with tabbed interface showing overview, subscription details, restaurants, and users
- **API Enhancements**: Added PUT /api/admin/tenants/:id for editing, POST suspend/unsuspend/pause endpoints with proper audit logging
- **Data Integrity**: Improved tenant data retrieval with comprehensive statistics and related entity information
- **2025-06-25**: Comprehensive admin panel system implemented under /admin
- **Admin System**: Complete separation from tenant system with dedicated authentication
- **Admin Features**: Dashboard with system stats, tenant management, subscription plans, admin users, system logs, and settings
- **Database Schema**: Added admin_users, admin_sessions, system_settings, and system_logs tables
- **Default Admin**: Created super admin account (admin@replit.com) with full system access
- **Security**: Robust authentication middleware and role-based access control
- **Admin UI**: Modern interface with dark theme, responsive design, and comprehensive management tools
- **System Monitoring**: Real-time logs, performance metrics, and health indicators
- **2025-06-25**: Migration from Replit Agent to Replit environment completed successfully
- **Database Integration**: PostgreSQL connection established with proper data persistence
- **Widget Integration**: Implemented embeddable booking widget system with OpenTable-style design
- **Modern Design System**: Added comprehensive theming with customizable colors, shadows, animations, and responsive design
- **Security Enhancement**: Improved error handling and implemented graceful fallback patterns
- **Print orders fixes**: Added missing DELETE endpoint for print orders API, fixed JSON error
- **UI improvements**: Updated Details button to icon-only display, removed Invoice button, and enhanced entire print orders page with premium animations and modern glassmorphism design
- **Sample data**: Added 22+ realistic bookings with past and future dates for testing
- **Product management**: Fixed product category dropdown, creation/update API data mapping, and display issues
- **Security**: Implemented client/server separation and robust security practices

## User Preferences
- Language: English/French (auto-detected)
- Communication: Professional, concise responses without emojis
- Technical approach: Comprehensive solutions with proper error handling

## Development Setup
- Port: 5000 (Express server)
- Development command: `npm run dev`
- Production build: `npm run build`
- Database migrations: `npm run db:push`

## Environment Status
- ✓ Node.js 20 installed
- ✓ All dependencies installed
- ✓ Database connected and configured
- ✓ Email service initialized
- ✓ Google Calendar service active
- ✓ Workflow running successfully